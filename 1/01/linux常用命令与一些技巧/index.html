<!DOCTYPE html>
<html lang="zh">
  <head>
    <title>
         - my101du Blog
      </title>
        <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
    <meta name="renderer" content="webkit">
    <meta http-equiv="Cache-Control" content="no-transform" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    
    <meta name="theme-color" content="#000000" />
    
    <meta http-equiv="window-target" content="_top" />
    
    
    <meta name="description" content="title: Linux常用命令与一些技巧 permalink: linux-command-and-skill date: 2015/03/05 10:10:10 tags: 运维 Linux 的精髓就在于命令行操作。指尖如飞，心随所动。 更好用的终端 安装 zsh 与 on-my-zsh yum -y install zsh zsh-completions sh -c &amp;quot;$(curl -fsSL https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh)&amp;quot; # 正常" />
    <meta name="generator" content="Hugo 0.70.0 with theme pure" />
    <title> - my101du Blog</title>
    
    
    <link rel="stylesheet" href="https://my101du.github.io/css/style.min.7dc20efbc53647d41aa9ddea0c48e59300223d084e66ea0cbe7c30bd88903acc.css">
    
    <link rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/9.15.10/styles/github.min.css" async>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css" async>
    <meta property="og:title" content="" />
<meta property="og:description" content="title: Linux常用命令与一些技巧 permalink: linux-command-and-skill date: 2015/03/05 10:10:10 tags: 运维 Linux 的精髓就在于命令行操作。指尖如飞，心随所动。 更好用的终端 安装 zsh 与 on-my-zsh yum -y install zsh zsh-completions sh -c &quot;$(curl -fsSL https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh)&quot; # 正常" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://my101du.github.io/1/01/linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E4%B8%8E%E4%B8%80%E4%BA%9B%E6%8A%80%E5%B7%A7/" />

<meta itemprop="name" content="">
<meta itemprop="description" content="title: Linux常用命令与一些技巧 permalink: linux-command-and-skill date: 2015/03/05 10:10:10 tags: 运维 Linux 的精髓就在于命令行操作。指尖如飞，心随所动。 更好用的终端 安装 zsh 与 on-my-zsh yum -y install zsh zsh-completions sh -c &quot;$(curl -fsSL https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh)&quot; # 正常">

<meta itemprop="wordCount" content="2691">



<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content=""/>
<meta name="twitter:description" content="title: Linux常用命令与一些技巧 permalink: linux-command-and-skill date: 2015/03/05 10:10:10 tags: 运维 Linux 的精髓就在于命令行操作。指尖如飞，心随所动。 更好用的终端 安装 zsh 与 on-my-zsh yum -y install zsh zsh-completions sh -c &quot;$(curl -fsSL https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh)&quot; # 正常"/>

    <!--[if lte IE 9]>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
      <![endif]-->

    <!--[if lt IE 9]>
        <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
      <![endif]-->
  </head>

  
  

  <body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage"><header class="header" itemscope itemtype="http://schema.org/WPHeader">
    <div class="slimContent">
      <div class="navbar-header">
        <div class="profile-block text-center">
          <a id="avatar" href="https://github.com/my101du" target="_blank">
            <img class="img-circle img-rotate" src="https://avatars2.githubusercontent.com/u/1332645?s=460&amp;u=dc114d6baad010456a5af87c4cc2df0694ff2b1c&amp;v=4" width="200" height="200">
          </a>
          <h2 id="name" class="hidden-xs hidden-sm">my101du</h2>
          <h3 id="title" class="hidden-xs hidden-sm hidden-md"></h3>
          <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i>Dongguan, China</small>
        </div><div class="search" id="search-form-wrap">
    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="搜索" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i
                        class="icon icon-search"></i></button>
            </span>
        </div>
        <div class="ins-search">
            <div class="ins-search-mask"></div>
            <div class="ins-search-container">
                <div class="ins-input-wrapper">
                    <input type="text" class="ins-search-input" placeholder="想要查找什么..."
                        x-webkit-speech />
                    <button type="button" class="close ins-close ins-selectable" data-dismiss="modal"
                        aria-label="Close"><span aria-hidden="true">×</span></button>
                </div>
                <div class="ins-section-wrapper">
                    <div class="ins-section-container"></div>
                </div>
            </div>
        </div>
    </form>
</div>
        <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
      </div>
      <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
        <ul class="nav navbar-nav main-nav">
            <li class="menu-item menu-item-home">
                <a href="/">
                    <i class="icon icon-home-fill"></i>
                  <span class="menu-title">Home</span>
                </a>
            </li>
            <li class="menu-item menu-item-archives">
                <a href="/posts/">
                    <i class="icon icon-archives-fill"></i>
                  <span class="menu-title">Archives</span>
                </a>
            </li>
            <li class="menu-item menu-item-categories">
                <a href="/categories/">
                    <i class="icon icon-folder"></i>
                  <span class="menu-title">Categories</span>
                </a>
            </li>
            <li class="menu-item menu-item-tags">
                <a href="/tags/">
                    <i class="icon icon-tags"></i>
                  <span class="menu-title">Tags</span>
                </a>
            </li>
            <li class="menu-item menu-item-about">
                <a href="/about/">
                    <i class="icon icon-cup-fill"></i>
                  <span class="menu-title">About</span>
                </a>
            </li>
        </ul>
      </nav>
    </div>
  </header>

<aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">公告</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content"><p>enjoy~</p>
            </div>
        </div>
    </div>
</div>

      <div class="widget">
    <h3 class="widget-title"> 分类</h3>
    <div class="widget-body">
        <ul class="category-list">
        </ul>
    </div>
</div>
      <div class="widget">
    <h3 class="widget-title"> 标签</h3>
    <div class="widget-body">
        <ul class="tag-list">
            
            
            <li class="tag-list-item"><a href="https://my101du.github.io/tags/skills/" class="tag-list-link">skills</a><span
                    class="tag-list-count">1</span></li>
            
        </ul>

    </div>
</div>
      
<div class="widget">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget-body">
        <ul class="recent-post-list list-unstyled no-thumbnail">
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://my101du.github.io/1/01/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" class="title"></a>
                    </p>
                    <p class="item-date">
                        <time datetime="0001-01-01 00:00:00 &#43;0000 UTC" itemprop="datePublished">0001-01-01</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://my101du.github.io/1/01/bootstrap-%E4%BB%A3%E7%A0%81%E7%89%87%E6%AE%B5%E4%B8%8E%E6%8A%80%E5%B7%A7/" class="title"></a>
                    </p>
                    <p class="item-date">
                        <time datetime="0001-01-01 00:00:00 &#43;0000 UTC" itemprop="datePublished">0001-01-01</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://my101du.github.io/1/01/bootstrap4/" class="title"></a>
                    </p>
                    <p class="item-date">
                        <time datetime="0001-01-01 00:00:00 &#43;0000 UTC" itemprop="datePublished">0001-01-01</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://my101du.github.io/1/01/css-%E5%8A%A8%E7%94%BB/" class="title"></a>
                    </p>
                    <p class="item-date">
                        <time datetime="0001-01-01 00:00:00 &#43;0000 UTC" itemprop="datePublished">0001-01-01</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://my101du.github.io/1/01/css-%E5%8A%A8%E7%94%BB%E5%BA%93-animate.css/" class="title"></a>
                    </p>
                    <p class="item-date">
                        <time datetime="0001-01-01 00:00:00 &#43;0000 UTC" itemprop="datePublished">0001-01-01</time>
                    </p>
                </div>
            </li>
        </ul>
    </div>
</div>
  </div>
</aside>

    
    
<aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <h4 class="toc-title">文章目录</h4>
    <nav id="toc" class="js-toc toc">

    </nav>
  </div>
</aside>
<main class="main" role="main"><div class="content">
  <article id="-" class="article article-type-" itemscope
    itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      <h1 itemprop="name">
  <a
    class="article-title"
    href="/1/01/linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E4%B8%8E%E4%B8%80%E4%BA%9B%E6%8A%80%E5%B7%A7/"
    ></a
  >
</h1>

      <div class="article-meta">
        

        <span class="post-comment"><i class="icon icon-comment"></i>&nbsp;<a href="/1/01/linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E4%B8%8E%E4%B8%80%E4%BA%9B%E6%8A%80%E5%B7%A7/#comments"
            class="article-comment-link">评论</a></span>
		<span class="post-wordcount hidden-xs" itemprop="wordCount">字数统计: 2691字</span>
		<span class="post-readcount hidden-xs" itemprop="timeRequired">阅读时长: 6分 </span>
      </div>
    </div>
    <div class="article-entry marked-body js-toc-content" itemprop="articleBody">
      <p>title: Linux常用命令与一些技巧
permalink: linux-command-and-skill
date: 2015/03/05 10:10:10
tags:</p>
<ul>
<li>运维</li>
</ul>
<hr>
<p><img src="/article_images/server/ubuntu%E5%91%BD%E4%BB%A4%E8%A1%8C.png" alt=""></p>
<p>Linux 的精髓就在于命令行操作。指尖如飞，心随所动。</p>
<!-- raw HTML omitted -->
<h1 id="更好用的终端">更好用的终端</h1>
<p>安装 zsh 与 on-my-zsh</p>
<pre><code class="language-shell">yum -y install zsh zsh-completions

sh -c &quot;$(curl -fsSL https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh)&quot;

# 正常情况下，自动修改了 shell 为 zsh  无需运行切换命令和重新退出
echo $SHELL

# ubuntu
sudo apt-get install -y zsh
sudo apt-get install powerline fonts-powerline

# 如果ubuntu 报 github 443 错误
git clone https://github.com/robbyrussell/oh-my-zsh.git ~/.oh-my-zsh
cp ~/.oh-my-zsh/templates/zshrc.zsh-template ~/.zshrc

vi .zshrc

# 编辑
ZSH_THEME=&quot;agnoster&quot;


chsh -s /bin/zsh
# 或者
chsh -s /usr/bin/zsh

# 检查当前默认 shell 是否已经从 bash 成为了 zsh
echo $SHELL
</code></pre>
<p>退出重新登录一次</p>
<p>或</p>
<pre><code class="language-shell">usermod -s /bin/zsh 

或
sudo vipw
# set zol's shell to /bin/zsh
:wq
</code></pre>
<h2 id="zsh与on-my-zsh-以及自定义">Zsh与on-my-zsh 以及自定义</h2>
<p>编辑 <code>.zshrc</code> 文件</p>
<pre><code class="language-shell"> ZSH_THEME=pygmalion
# Use sublimetext for editing config files
alias zshconfig=&quot;subl ~/.zshrc&quot;
alias envconfig=&quot;subl ~/Projects/config/env.sh&quot;
plugins=(git colored-man colorize github jira vagrant virtualenv pip the brew osx zsh-syntax-highlighting)

# Add env.sh
. ~/Projects/config/env.sh
</code></pre>
<p>修改终端提示（显示当前用户/主机名）</p>
<p>添加</p>
<pre><code>PROMPT='%(!.%{%F{yellow}%}.)$USER @ %{$fg[white]%}%M %{$fg_bold[red]%}➜ %{$fg_bold[green]%}%p %{$fg[cyan]%}%c %{$fg_bold[blue]%}$(git_prompt_info)%{$fg_bold[blue]%} % %{$reset_color%}'
</code></pre>
<p>以及 <code>env.sh</code> 文件</p>
<pre><code class="language-shell">#!/bin/zsh

# PATH
export PATH=&quot;/usr/local/share/python:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin&quot;
export EDITOR='subl -w'
# export PYTHONPATH=$PYTHONPATH
# export MANPATH=&quot;/usr/local/man:$MANPATH&quot;

# Virtual Environment
export WORKON_HOME=$HOME/.virtualenvs
export PROJECT_HOME=$HOME/Projects
source /usr/local/bin/virtualenvwrapper.sh

# Owner
export USER_NAME=&quot;YOUR NAME&quot;
eval &quot;$(rbenv init -)&quot;

# FileSearch
function f() { find . -iname &quot;*$1*&quot; ${@:2} }
function r() { grep &quot;$1&quot; ${@:2} -R . }

#mkdir and cd
function mkcd() { mkdir -p &quot;$@&quot; &amp;&amp; cd &quot;$_&quot;; }

# Aliases
alias cppcompile='c++ -std=c++11 -stdlib=libc++'
</code></pre>
<p>使用 oh-my-zsh 装插件</p>
<p>首先 clone 到目录</p>
<pre><code class="language-shell"> git clone https://github.com/zsh-users/zsh-syntax-highlighting.git ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-syntax-highlighting
 
 git clone https://github.com/zsh-users/zsh-autosuggestions ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-autosuggestions
</code></pre>
<p>修改 ~/.zsh,添加</p>
<pre><code class="language-shell">plugins=(
  git
  bundler
  dotenv
  osx
  rake
  rbenv
  ruby
  zsh-syntax-highlighting
  zsh-autosuggestions
)
</code></pre>
<p>最后激活</p>
<pre><code class="language-shell">source ~/.zshrc
</code></pre>
<p>所有插件
<a href="https://github.com/robbyrussell/oh-my-zsh/wiki/Plugins">https://github.com/robbyrussell/oh-my-zsh/wiki/Plugins</a></p>
<h2 id="fish--二b用-bash-普通青年用-zsh-文艺青年用-fish">fish  二B用 bash, 普通青年用 zsh 文艺青年用 fish&hellip;.</h2>
<p>不需要那么多配置，不需要装那么多插件，自动提示等。</p>
<p><a href="http://www.ruanyifeng.com/blog/2017/05/fish_shell.html">http://www.ruanyifeng.com/blog/2017/05/fish_shell.html</a></p>
<p>但是，一些命令不支持，例如 export 等。不兼容 &amp;&amp; 等，需要学一门新的东西。</p>
<p>所以改成 zsh + oh-my-zsh</p>
<p>插件： zsh-syntax-highlighting + zsh-autosuggestions</p>
<h1 id="tmux">tmux</h1>
<p>一般 Linux 都是远程的 VPS 或服务器，我们在使用 SSH 从本机登录后，希望能像Mac 里的 <code>iTerm</code> 或者  windows里的<code>XShell</code>、<code>SecureCRT</code>一样，同时管理多个终端窗口。</p>
<p>那么可以用 <code>tmux</code> 或者 <code>screen</code>，推荐用 <code>tmux</code>。</p>
<p><a href="http://blog.jobbole.com/87584/">http://blog.jobbole.com/87584/</a></p>
<h1 id="基本">基本</h1>
<h2 id="if-else">if else</h2>
<p>。。</p>
<p>如果 then 后面不需要执行任何代码，需要添加一个 &ldquo;:&rdquo; 符号</p>
<pre><code class="language-shell">
</code></pre>
<h1 id="文件相关">文件相关</h1>
<h2 id="后悔药-修改-rm-命令实际上为移动到回收站">后悔药， 修改 rm 命令实际上为移动到回收站</h2>
<pre><code class="language-shell"># 删除当前目录下文件 
rm -rf ./*

# 一不小心少打了个点，把根目录给删除了
rm -rf /*
</code></pre>
<p>但可以先将它们放到回收站</p>
<p>修改<code>.bashrc</code>文件或<code>.profile</code>，添加</p>
<pre><code class="language-shell">alias rm=trash
</code></pre>
<p>如果想要有一些快捷方式，还可以创建一个命令，并让它开机运行一次</p>
<pre><code class="language-shell">mkdir -p ~/.trash  //创建一个目录作为回收站，这里使用的是用户家目录下的.trash目录 
alias rm=trash  //命令别名 rm改变为trash，通过将rm命令别名值trash来实现把rm改造成删除文件至回收站 
alias r=trash  
alias rl='ls ~/.trash'  // rl 命令显示回收站中的文件 
alias ur=undelfile // ur命令找回回收站中的文件 
undelfile() //这个函数的作用是找回回收站下的文件 
{  
  mv -i ~/.trash/\$@ ./  
}  
trash() //这个函数是将指定的文件移动到指定的目录下，通过将rm命令别名值trash来实现把rm改造成删除文件至回收站 
{  
  mv $@ ~/.trash/  
}  
cleartrash()  //这个函数的作用是清空回收站目录下的所有文件 
{  
    read -p &quot;clear sure?[n]&quot; confirm   
    [ $confirm == 'y' ] || [ $confirm == 'Y' ]  &amp;&amp; /bin/rm -rf ~/.trash/*   
}  
</code></pre>
<h2 id="文件处理">文件处理</h2>
<p><strong>复制一个文件夹的文件，到另外一个文件夹，但是不覆盖已经存在/更新的</strong></p>
<pre><code class="language-shell">cp -n -r ./origin/* ./dest/
</code></pre>
<h2 id="查看目录或文件">查看目录或文件</h2>
<p><strong>查看某目录下文件/目录的数量</strong></p>
<pre><code class="language-shell">ls -l |grep &quot;^-&quot;|wc -l
# 或
find ./company -type f | wc -l

# 查看某目录下文件的个数，包括子目录里的。
ls -lR|grep &quot;^-&quot;|wc -l

# 查看某文件夹下目录的个数，包括子目录里的。
ls -lR|grep &quot;^d&quot;|wc -l
</code></pre>
<p><strong>只列出目录</strong></p>
<pre><code class="language-shell">ls -d */
</code></pre>
<p><strong>按时间排序</strong></p>
<pre><code class="language-shell">ls -lt

# 最新的排在最后
ls -lrt
</code></pre>
<p><strong>tree 命令列出文件结构</strong></p>
<pre><code class="language-shell">$ tree -L 2

# 如果出现菱形的汉字乱码（一般 Git 项目里有中文目录和文件会遇到），则添加 -N 参数，用原样输出

tree -N -L2 ./
</code></pre>
<p><strong>查找并复制</strong></p>
<pre><code class="language-shell">find /home/shantanu/processed/ -name '*2011*.xml' -exec cp {} /home/shantanu/tosend  \;
</code></pre>
<h2 id="tar-打包与解压">tar 打包与解压</h2>
<p><strong>排除一个或多个子目录</strong>
在htdocs上级目录执行，注意要用*号把里面的文件包括进来</p>
<pre><code class="language-shell">tar --exclude=htdocs/XXX/*  --exclude=htdocs/XXX  -zcvf xxx.tar.gz htdocs/*
</code></pre>
<p><strong>解压到指定目录</strong></p>
<pre><code class="language-shell">tar zxvf -C [target] file.tar.gz
</code></pre>
<p><strong>同时解压多个 tar.gz 压缩包</strong></p>
<pre><code class="language-shell">for tarfile in ./*.tar.gz; do tar zxvf $tarfile; done
</code></pre>
<h2 id="根据一个列表查找文件是否存在">根据一个列表，查找文件是否存在</h2>
<p>实现把要检查的文件名放入一个 filenames.txt 文件如</p>
<blockquote>
<p>aa
bb
cc</p>
</blockquote>
<p>运行下面的脚本<code>./check.sh filenames.txt</code></p>
<pre><code class="language-shell">#!/bin/bash

path=`pwd`

while IFS='' read -r line || [[ -n &quot;$line&quot; ]]; do
  file=&quot;${path}/products/${line}.jpg&quot;
  if [ -f &quot;$file&quot; ]
  then
    :
#   echo &quot;$file found.&quot;
  else
    echo &quot;$line&quot; &gt;&gt; notfound.txt
  fi
done &lt; &quot;$1&quot;
</code></pre>
<p>文件不存在的话，放入 nofound.txt</p>
<h2 id="对比两个目录的异同">对比两个目录的异同</h2>
<pre><code class="language-shell">diff -rq folder_1 folder_2

Only in folder_1: test.txt
Only in folder_2: test_2.txt
</code></pre>
<h2 id="unzip">unzip</h2>
<pre><code class="language-shell"># 解压一个
unzip 1.zip

# 同时解压多个
unzip \*.zip
</code></pre>
<h1 id="时间">时间</h1>
<p>输出格式化的日期</p>
<pre><code class="language-shell"># Mon May 21 16:41:00 CST 2018
date

# 20180521
echo $(date +%Y%m%d)
</code></pre>
<h1 id="网络相关">网络相关</h1>
<h2 id="ifconfig">ifconfig</h2>
<h2 id="netstat">netstat</h2>
<p>查看当前运行的进程与所监听的端口</p>
<pre><code class="language-shell">netstat -nltpl 

Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        0      0 0.0.0.0:3306            0.0.0.0:*               LISTEN      1724/mysqld
tcp        0      0 127.0.0.1:43467         0.0.0.0:*               LISTEN      12203/node
tcp        0      0 0.0.0.0:111             0.0.0.0:*               LISTEN      1/systemd
tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      22104/nginx: master
tcp        0      0 0.0.0.0:20422           0.0.0.0:*               LISTEN      26584/sshd
tcp6       0      0 :::7000                 :::*                    LISTEN      5720/frps 
</code></pre>
<h2 id="快速返回你的ip地址和所在的地理位置">快速返回你的IP地址和所在的地理位置</h2>
<pre><code class="language-shell">$curl ip.gs
</code></pre>
<h2 id="curl">curl</h2>
<p>curl 模拟一个 post 请求，提交 json 数据</p>
<pre><code class="language-shell">curl -H &quot;Content-Type:application/json&quot; -X POST --data '{&quot;app_id&quot;: &quot;test&quot;, &quot;secret_key&quot;: &quot;test&quot;}' https://example.org/api/users
</code></pre>
<h1 id="系统">系统</h1>
<h2 id="修改hostname">修改hostname</h2>
<p><strong>永久修改</strong>
修改 <code>/etc/sysconfig/network</code>，在里面指定主机名称 <code>HOSTNAME=</code>
然后执行命令 <code>hostname 主机名</code></p>
<p>或者修改 <code>/etc/hosts</code> 文件中添加 <code>192.168.2.13      linux     ####ip ＋主机名</code>
然后运行 <code>hostname 主机名</code></p>
<p>注销系统，重登录</p>
<p><strong>临时修改：</strong>
shell下执行 <code>#hostname    主机名</code>
ctrl＋d注销一下系统，再重登录</p>
<p>先用hostname修改，然后export HOSTNAME=新主机名</p>
<p>快捷：</p>
<pre><code class="language-shell">hostnamectl set-hostname 主机名 ; 修改后需重新连接ssh
</code></pre>
<h2 id="使用nohup在后台运行scp">使用nohup在后台运行scp</h2>
<p>对于scp的用法见：http://blog.haohtml.com/archives/10516</p>
<p>需要从远程拷贝一个比较大的文件，因为耗时很长，就会产生两个问题</p>
<ol>
<li>因为 scp 的当前进度显示会占用当前终端的操作，你无法进行其他命令</li>
<li>有时候因为 ssh 登录参数的设置，到一定时间后会触发“超时”，提示重新输入密码</li>
</ol>
<p>为了不影响其他工作，所以要让SCP在<strong>后台</strong>运行</p>
<p>虽然使用 ssh 的 public key 可以让两台机器可以不用密码连接，但不是每个人都有这个条件的，所以可以使用下面的方法实现：</p>
<ol>
<li>nohup scp user@server:path/file localpath</li>
<li>输入密码</li>
<li>按 <code>Ctrl+z</code> 挂起当前进程</li>
<li>使用命令 <code>bg</code> 让挂起的进程继续运行</li>
</ol>
<h2 id="其他后台运行方式有的系统没有-nohup-例如威联通的-nas">其他后台运行方式（有的系统没有 nohup 例如威联通的 nas）</h2>
<p><a href="https://www.ibm.com/developerworks/cn/linux/l-cn-nohup/">https://www.ibm.com/developerworks/cn/linux/l-cn-nohup/</a></p>
<h2 id="crontab-计划任务">crontab 计划任务</h2>
<p><strong>格式</strong>
分 时 日 月 周 命令</p>
<ul>
<li>
<ul>
<li>
<ul>
<li>
<ul>
<li>
<ul>
<li>command</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>以一定的频率定时执行</strong>
*/5 * * * * command
每 5分钟执行一次</p>
<p><strong>使用函数。注意如果使用了特殊字符，要进行转义</strong>
*/5 * * * * curl -l &ldquo;<a href="http://www.test.com/?action=check&amp;date=$(date">http://www.test.com/?action=check&amp;date=$(date</a> +%Y%m%d)&rdquo;</p>
<h1 id="进程管理">进程管理</h1>
<pre><code class="language-shell"># 查看
ps -ef|grep nginx

# 杀死 by  pid(如果上面的查看结果有多个，要一个个杀)
kill -9 52345

# 通过进程名批量杀（多个子进程）
pkill php-fpm
</code></pre>
<h1 id="top-命令">top 命令</h1>
<p>按 e 键切换计算方式， 例如 Mb Gb Kb</p>
<p>按 m 按内存占用排序。</p>
<h2 id="awk">awk</h2>
<p>文本分析工具，相对于grep的查找，sed的编辑，awk在其对数据分析并生成报告时，显得尤为强大.awk就是把文件<strong>逐行</strong>的读入，以空格为默认分隔符将每行<strong>切片</strong>，切开的部分再进行各种<strong>分析处理</strong></p>
<p>基本</p>
<pre><code class="language-shell">awk '{pattern + action}' {filenames}
</code></pre>
<p><code>pattern</code> 表示 AWK 在数据中查找的内容(正则表达式，用斜杠括起来)
<code>action</code> 是在找到匹配内容时所执行的一系列命令
<code>花括号（{}）</code>不需要在程序中始终出现，但它们用于根据特定的模式对一系列指令进行分组</p>
<p>参考</p>
<p><a href="https://www.cnblogs.com/ggjucheng/archive/2013/01/13/2858470.html">https://www.cnblogs.com/ggjucheng/archive/2013/01/13/2858470.html</a></p>
<p><a href="https://stackoverflow.com/questions/7706095/filter-log-file-entries-based-on-date-range">https://stackoverflow.com/questions/7706095/filter-log-file-entries-based-on-date-range</a></p>
<p>yes, there are multiple ways to do this. Here is how I would go about this. For starters, no need to pipe the output of cat, just open the log file with awk.</p>
<p>awk -vDate=<code>date -d'now-2 hours' +[%d/%b/%Y:%H:%M:%S</code> &lsquo;$4 &gt; Date {print Date, $0}&rsquo; access_log
assuming your log looks like mine (they&rsquo;re configurable) than the date is stored in field 4. and is bracketed. What I am doing above is finding everything within the last 2 hours. Note the -d&rsquo;now-2 hours&rsquo; or translated literally now minus 2 hours which for me looks something like this: [10/Oct/2011:08:55:23</p>
<p>So what I am doing is storing the formatted value of two hours ago and comparing against field four. The conditional expression should be straight forward.I am then printing the Date, followed by the Output Field Separator (OFS &ndash; or space in this case) followed by the whole line $0. You could use your previous expression and just print $1 (the ip addresses)</p>
<p>awk -vDate=<code>date -d'now-2 hours' +[%d/%b/%Y:%H:%M:%S</code> &lsquo;$4 &gt; Date {print $1}&rsquo; | sort  |uniq -c |sort -n | tail
If you wanted to use a range specify two date variables and construct your expression appropriately.</p>
<p>so if you wanted do find something between 2-4hrs ago your expression might looks something like this</p>
<p>awk -vDate=<code>date -d'now-4 hours' +[%d/%b/%Y:%H:%M:%S</code> -vDate2=<code>date -d'now-2 hours' +[%d/%b/%Y:%H:%M:%S</code> &lsquo;$4 &gt; Date &amp;&amp; $4 &lt; Date2 {print Date, Date2, $4} access_log&rsquo;
Here is a question I answered regarding dates in bash you might find helpful. Print date for the monday of the current week (in bash)</p>
<h2 id="sed">sed</h2>

    </div>
    <div class="article-footer">
<blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接: </strong>
      <a href="https://my101du.github.io/1/01/linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E4%B8%8E%E4%B8%80%E4%BA%9B%E6%8A%80%E5%B7%A7/" title="" target="_blank" rel="external">https://my101du.github.io/1/01/linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E4%B8%8E%E4%B8%80%E4%BA%9B%E6%8A%80%E5%B7%A7/</a>
    </li>
    <li class="post-copyright-license">
      <strong>License：</strong><a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN</a>
    </li>
  </ul>
</blockquote>

<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="https://github.com/my101du" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="https://avatars2.githubusercontent.com/u/1332645?s=460&amp;u=dc114d6baad010456a5af87c4cc2df0694ff2b1c&amp;v=4" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="https://github.com/my101du" target="_blank"><span class="text-dark">my101du</span><small class="ml-1x"></small></a></h3>
        <div>Stay Hungry, Stay Foolish</div>
      </div>
    </figure>
  </div>
</div>
    </div>
  </article>
<section id="comments">
</section>

</div><nav class="bar bar-footer clearfix" data-stick-bottom>
    <div class="bar-inner">
        <ul class="pager pull-left">
            <li class="prev">
                <a href="https://my101du.github.io/1/01/nginx%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE/" title=""><i
                        class="icon icon-angle-left"
                        aria-hidden="true"></i><span>&nbsp;&nbsp;下一篇</span></a>
            </li>
            <li class="next">
                <a href="https://my101du.github.io/1/01/linux%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AEcentos/"
                    title=""><span>上一篇&nbsp;&nbsp;</span><i
                        class="icon icon-angle-right" aria-hidden="true"></i></a>
            </li>
            
            <li class="toggle-toc">
                <a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false"
                    title="文章目录" role="button">
                    <span>[&nbsp;</span><span>文章目录</span>
                    <i class="text-collapsed icon icon-anchor"></i>
                    <i class="text-in icon icon-close"></i>
                    <span>]</span>
                </a>
            </li>
        </ul>
        <div class="bar-right">
            <div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter"
                data-mobile-sites="weibo,qq,qzone"></div>
        </div>
    </div>
</nav>

</main><footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
<ul class="social-links">
    <li><a href="https://github.com/my101du" target="_blank" title="github" data-toggle=tooltip data-placement=top >
            <i class="icon icon-github"></i></a></li>
    <li><a href="https://my101du.github.io/index.xml" target="_blank" title="rss" data-toggle=tooltip data-placement=top >
            <i class="icon icon-rss"></i></a></li>
</ul>
  <div class="copyright">
    &copy;2017  -
    2020
    <div class="publishby">
        Theme by <a href="https://github.com/xiaoheiAh" target="_blank"> xiaoheiAh </a>base on<a href="https://github.com/xiaoheiAh/hugo-theme-pure" target="_blank"> pure</a>.
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_SVG"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
            showMathMenu: false, //disables context menu
            tex2jax: {
            inlineMath: [ ['$','$'], ['\\(','\\)'] ]
           }
    });
</script>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
<script>
    window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>
<script type="text/javascript" src="https://cdn.staticfile.org/highlight.js/9.15.10/highlight.min.js"></script>
<script type="text/javascript" src="https://cdn.staticfile.org/highlight.js/9.15.10/languages/javascript.min.js" defer></script>
<script type="text/javascript" src="https://cdn.staticfile.org/highlight.js/9.15.10/languages/php.min.js" defer></script><script>
    hljs.configure({
        tabReplace: '    ', 
        classPrefix: ''     
        
    })
    hljs.initHighlightingOnLoad();
</script>
<script src="https://my101du.github.io/js/application.min.bdeb64b910570b6c41badc6a05b7afb0c8ad9efd8525de3c7257d59e786326a3.js"></script>
<script src="https://my101du.github.io/js/plugin.min.51ff8c7317566f82259170fa36e09c4493adc9b9378b427a01ad3f017ebac7dd.js"></script>

<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: '文章',
                PAGES: '页面',
                CATEGORIES: '分类',
                TAGS: '标签',
                UNTITLED: '(未命名)',
            },
            ROOT_URL: 'https:\/\/my101du.github.io\/',
            CONTENT_URL: 'https:\/\/my101du.github.io\/\/searchindex.json ',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script type="text/javascript" src="https://my101du.github.io/js/insight.min.a343cd9a5a7698336b28ef3a7c16a3a1b1d2d5fb17dc8ed04022bbe08cc5459073a15bdafa3a8a58cdd56080784bdd69fa70b1ae8597565c799c57ed00f0e120.js" defer></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
<script>
    tocbot.init({
        
        tocSelector: '.js-toc',
        
        contentSelector: '.js-toc-content',
        
        headingSelector: 'h1, h2, h3',
        
        hasInnerContainers: true,
    });
</script>


  </body>
</html>
