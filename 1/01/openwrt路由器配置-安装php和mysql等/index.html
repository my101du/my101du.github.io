<!DOCTYPE html>
<html lang="zh">
  <head>
    <title>
         - my101du Blog
      </title>
        <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
    <meta name="renderer" content="webkit">
    <meta http-equiv="Cache-Control" content="no-transform" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    
    <meta name="theme-color" content="#000000" />
    
    <meta http-equiv="window-target" content="_top" />
    
    
    <meta name="description" content="title: OpenWRT路由器配置-安装PHP和MySQL等 permalink: openwrt-config-install-php-mysql tags:
 OpenWRT 工具   OpenWRT 是一种运行在智能路由器上的操作系统。
关于OpenWRT、购买、改造、刷固件 OpenWRT是一个运行在智能路由器上的Linux类操作系统。
普通的路由器只能简单地进行数据传输以及设置一些厂商指定的参数，而刷了OpenWRT系统后，路由器的可玩性大大增强。因为它实际上是一个Linux系统，所以你可以远程登录、安装各种软件和开发环境、设置为FTP服务器、文件共享服务器、下载服务器等等。
可玩性很强，具体可以去国内较出名的恩山论坛逛逛。
支持刷入OpenWRT系统的路由器型号非常多，有的自带了USB接口可以作为扩展存储接口，有的内存和CPU都很强，但一般价格都比较昂贵。
于是有发烧友就采购比较便宜的路由器，然后自己动手，往主板上面焊接大内存、添加USB扩展口等等。
如果你不在乎钱并且时间宝贵，直接购买高端的路由吧。
如果你想节省成本，并且体验一把极客的感觉，可以上taobao买这些玩家改造的路由器，其实都还比较稳定，并且发货前都已经刷好了OpenWRT 。
" />
    <meta name="generator" content="Hugo 0.70.0 with theme pure" />
    <title> - my101du Blog</title>
    
    
    <link rel="stylesheet" href="https://my101du.github.io/css/style.min.7dc20efbc53647d41aa9ddea0c48e59300223d084e66ea0cbe7c30bd88903acc.css">
    
    <link rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/9.15.10/styles/github.min.css" async>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css" async>
    <meta property="og:title" content="" />
<meta property="og:description" content="title: OpenWRT路由器配置-安装PHP和MySQL等
permalink: openwrt-config-install-php-mysql
tags:

OpenWRT
工具


OpenWRT 是一种运行在智能路由器上的操作系统。

关于OpenWRT、购买、改造、刷固件
OpenWRT是一个运行在智能路由器上的Linux类操作系统。
普通的路由器只能简单地进行数据传输以及设置一些厂商指定的参数，而刷了OpenWRT系统后，路由器的可玩性大大增强。因为它实际上是一个Linux系统，所以你可以远程登录、安装各种软件和开发环境、设置为FTP服务器、文件共享服务器、下载服务器等等。
可玩性很强，具体可以去国内较出名的恩山论坛逛逛。
支持刷入OpenWRT系统的路由器型号非常多，有的自带了USB接口可以作为扩展存储接口，有的内存和CPU都很强，但一般价格都比较昂贵。
于是有发烧友就采购比较便宜的路由器，然后自己动手，往主板上面焊接大内存、添加USB扩展口等等。
如果你不在乎钱并且时间宝贵，直接购买高端的路由吧。
如果你想节省成本，并且体验一把极客的感觉，可以上taobao买这些玩家改造的路由器，其实都还比较稳定，并且发货前都已经刷好了OpenWRT 。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://my101du.github.io/1/01/openwrt%E8%B7%AF%E7%94%B1%E5%99%A8%E9%85%8D%E7%BD%AE-%E5%AE%89%E8%A3%85php%E5%92%8Cmysql%E7%AD%89/" />

<meta itemprop="name" content="">
<meta itemprop="description" content="title: OpenWRT路由器配置-安装PHP和MySQL等
permalink: openwrt-config-install-php-mysql
tags:

OpenWRT
工具


OpenWRT 是一种运行在智能路由器上的操作系统。

关于OpenWRT、购买、改造、刷固件
OpenWRT是一个运行在智能路由器上的Linux类操作系统。
普通的路由器只能简单地进行数据传输以及设置一些厂商指定的参数，而刷了OpenWRT系统后，路由器的可玩性大大增强。因为它实际上是一个Linux系统，所以你可以远程登录、安装各种软件和开发环境、设置为FTP服务器、文件共享服务器、下载服务器等等。
可玩性很强，具体可以去国内较出名的恩山论坛逛逛。
支持刷入OpenWRT系统的路由器型号非常多，有的自带了USB接口可以作为扩展存储接口，有的内存和CPU都很强，但一般价格都比较昂贵。
于是有发烧友就采购比较便宜的路由器，然后自己动手，往主板上面焊接大内存、添加USB扩展口等等。
如果你不在乎钱并且时间宝贵，直接购买高端的路由吧。
如果你想节省成本，并且体验一把极客的感觉，可以上taobao买这些玩家改造的路由器，其实都还比较稳定，并且发货前都已经刷好了OpenWRT 。">

<meta itemprop="wordCount" content="2467">



<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content=""/>
<meta name="twitter:description" content="title: OpenWRT路由器配置-安装PHP和MySQL等
permalink: openwrt-config-install-php-mysql
tags:

OpenWRT
工具


OpenWRT 是一种运行在智能路由器上的操作系统。

关于OpenWRT、购买、改造、刷固件
OpenWRT是一个运行在智能路由器上的Linux类操作系统。
普通的路由器只能简单地进行数据传输以及设置一些厂商指定的参数，而刷了OpenWRT系统后，路由器的可玩性大大增强。因为它实际上是一个Linux系统，所以你可以远程登录、安装各种软件和开发环境、设置为FTP服务器、文件共享服务器、下载服务器等等。
可玩性很强，具体可以去国内较出名的恩山论坛逛逛。
支持刷入OpenWRT系统的路由器型号非常多，有的自带了USB接口可以作为扩展存储接口，有的内存和CPU都很强，但一般价格都比较昂贵。
于是有发烧友就采购比较便宜的路由器，然后自己动手，往主板上面焊接大内存、添加USB扩展口等等。
如果你不在乎钱并且时间宝贵，直接购买高端的路由吧。
如果你想节省成本，并且体验一把极客的感觉，可以上taobao买这些玩家改造的路由器，其实都还比较稳定，并且发货前都已经刷好了OpenWRT 。"/>

    <!--[if lte IE 9]>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
      <![endif]-->

    <!--[if lt IE 9]>
        <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
      <![endif]-->
  </head>

  
  

  <body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage"><header class="header" itemscope itemtype="http://schema.org/WPHeader">
    <div class="slimContent">
      <div class="navbar-header">
        <div class="profile-block text-center">
          <a id="avatar" href="https://github.com/my101du" target="_blank">
            <img class="img-circle img-rotate" src="https://avatars2.githubusercontent.com/u/1332645?s=460&amp;u=dc114d6baad010456a5af87c4cc2df0694ff2b1c&amp;v=4" width="200" height="200">
          </a>
          <h2 id="name" class="hidden-xs hidden-sm">my101du</h2>
          <h3 id="title" class="hidden-xs hidden-sm hidden-md"></h3>
          <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i>Dongguan, China</small>
        </div><div class="search" id="search-form-wrap">
    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="搜索" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i
                        class="icon icon-search"></i></button>
            </span>
        </div>
        <div class="ins-search">
            <div class="ins-search-mask"></div>
            <div class="ins-search-container">
                <div class="ins-input-wrapper">
                    <input type="text" class="ins-search-input" placeholder="想要查找什么..."
                        x-webkit-speech />
                    <button type="button" class="close ins-close ins-selectable" data-dismiss="modal"
                        aria-label="Close"><span aria-hidden="true">×</span></button>
                </div>
                <div class="ins-section-wrapper">
                    <div class="ins-section-container"></div>
                </div>
            </div>
        </div>
    </form>
</div>
        <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
      </div>
      <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
        <ul class="nav navbar-nav main-nav">
            <li class="menu-item menu-item-home">
                <a href="/">
                    <i class="icon icon-home-fill"></i>
                  <span class="menu-title">Home</span>
                </a>
            </li>
            <li class="menu-item menu-item-archives">
                <a href="/posts/">
                    <i class="icon icon-archives-fill"></i>
                  <span class="menu-title">Archives</span>
                </a>
            </li>
            <li class="menu-item menu-item-categories">
                <a href="/categories/">
                    <i class="icon icon-folder"></i>
                  <span class="menu-title">Categories</span>
                </a>
            </li>
            <li class="menu-item menu-item-tags">
                <a href="/tags/">
                    <i class="icon icon-tags"></i>
                  <span class="menu-title">Tags</span>
                </a>
            </li>
            <li class="menu-item menu-item-about">
                <a href="/about/">
                    <i class="icon icon-cup-fill"></i>
                  <span class="menu-title">About</span>
                </a>
            </li>
        </ul>
      </nav>
    </div>
  </header>

<aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">公告</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content"><p>enjoy~</p>
            </div>
        </div>
    </div>
</div>

      <div class="widget">
    <h3 class="widget-title"> 分类</h3>
    <div class="widget-body">
        <ul class="category-list">
        </ul>
    </div>
</div>
      <div class="widget">
    <h3 class="widget-title"> 标签</h3>
    <div class="widget-body">
        <ul class="tag-list">
            
            
            <li class="tag-list-item"><a href="https://my101du.github.io/tags/skills/" class="tag-list-link">skills</a><span
                    class="tag-list-count">1</span></li>
            
        </ul>

    </div>
</div>
      
<div class="widget">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget-body">
        <ul class="recent-post-list list-unstyled no-thumbnail">
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://my101du.github.io/1/01/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" class="title"></a>
                    </p>
                    <p class="item-date">
                        <time datetime="0001-01-01 00:00:00 &#43;0000 UTC" itemprop="datePublished">0001-01-01</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://my101du.github.io/1/01/bootstrap-%E4%BB%A3%E7%A0%81%E7%89%87%E6%AE%B5%E4%B8%8E%E6%8A%80%E5%B7%A7/" class="title"></a>
                    </p>
                    <p class="item-date">
                        <time datetime="0001-01-01 00:00:00 &#43;0000 UTC" itemprop="datePublished">0001-01-01</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://my101du.github.io/1/01/bootstrap4/" class="title"></a>
                    </p>
                    <p class="item-date">
                        <time datetime="0001-01-01 00:00:00 &#43;0000 UTC" itemprop="datePublished">0001-01-01</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://my101du.github.io/1/01/css-%E5%8A%A8%E7%94%BB/" class="title"></a>
                    </p>
                    <p class="item-date">
                        <time datetime="0001-01-01 00:00:00 &#43;0000 UTC" itemprop="datePublished">0001-01-01</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://my101du.github.io/1/01/css-%E5%8A%A8%E7%94%BB%E5%BA%93-animate.css/" class="title"></a>
                    </p>
                    <p class="item-date">
                        <time datetime="0001-01-01 00:00:00 &#43;0000 UTC" itemprop="datePublished">0001-01-01</time>
                    </p>
                </div>
            </li>
        </ul>
    </div>
</div>
  </div>
</aside>

    
    
<aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <h4 class="toc-title">文章目录</h4>
    <nav id="toc" class="js-toc toc">

    </nav>
  </div>
</aside>
<main class="main" role="main"><div class="content">
  <article id="-" class="article article-type-" itemscope
    itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      <h1 itemprop="name">
  <a
    class="article-title"
    href="/1/01/openwrt%E8%B7%AF%E7%94%B1%E5%99%A8%E9%85%8D%E7%BD%AE-%E5%AE%89%E8%A3%85php%E5%92%8Cmysql%E7%AD%89/"
    ></a
  >
</h1>

      <div class="article-meta">
        

        <span class="post-comment"><i class="icon icon-comment"></i>&nbsp;<a href="/1/01/openwrt%E8%B7%AF%E7%94%B1%E5%99%A8%E9%85%8D%E7%BD%AE-%E5%AE%89%E8%A3%85php%E5%92%8Cmysql%E7%AD%89/#comments"
            class="article-comment-link">评论</a></span>
		<span class="post-wordcount hidden-xs" itemprop="wordCount">字数统计: 2467字</span>
		<span class="post-readcount hidden-xs" itemprop="timeRequired">阅读时长: 5分 </span>
      </div>
    </div>
    <div class="article-entry marked-body js-toc-content" itemprop="articleBody">
      <p>title: OpenWRT路由器配置-安装PHP和MySQL等
permalink: openwrt-config-install-php-mysql
tags:</p>
<ul>
<li>OpenWRT</li>
<li>工具</li>
</ul>
<hr>
<p>OpenWRT 是一种运行在智能路由器上的操作系统。</p>
<!-- raw HTML omitted -->
<h1 id="关于openwrt购买改造刷固件">关于OpenWRT、购买、改造、刷固件</h1>
<p>OpenWRT是一个运行在智能路由器上的Linux类操作系统。</p>
<p>普通的路由器只能简单地进行数据传输以及设置一些厂商指定的参数，而刷了OpenWRT系统后，路由器的可玩性大大增强。因为它实际上是一个Linux系统，所以你可以远程登录、安装各种软件和开发环境、设置为FTP服务器、文件共享服务器、下载服务器等等。</p>
<p>可玩性很强，具体可以去国内较出名的<a href="http://www.right.com.cn/forum/forum.php">恩山论坛</a>逛逛。</p>
<p>支持刷入OpenWRT系统的路由器型号非常多，有的自带了USB接口可以作为扩展存储接口，有的内存和CPU都很强，但一般价格都比较昂贵。</p>
<p>于是有发烧友就采购比较便宜的路由器，然后自己动手，往主板上面焊接大内存、添加USB扩展口等等。</p>
<p>如果你不在乎钱并且时间宝贵，直接购买高端的路由吧。</p>
<p>如果你想节省成本，并且体验一把极客的感觉，可以上taobao买这些玩家改造的路由器，其实都还比较稳定，并且发货前都已经刷好了OpenWRT 。</p>
<p>例如我买的这款：水星MW151RM（和非常火爆的TP-Link一款迷你路由是同样的主板），就是卖家改了64M内存，焊接了USB接口，而价格才几十块钱……</p>
<p><img src="/article_images/tools/openwrt-config-install-php-mysql/mw151rm_openwrt.jpg" alt=""></p>
<p>因为OpenWRT在不断升级，完善bug和增加功能，因此你也可以下载适合自己设备的新的固件，升级路由器~</p>
<h1 id="初始设置">初始设置</h1>
<h2 id="基本的网络连接设置">基本的网络连接设置</h2>
<p>新买来的路由器必须要经过一番简单的设置才能使用，以实现基本的上网功能。</p>
<p><strong>把电脑与路由器连接到一个局域网内</strong></p>
<ol>
<li>接通路由器电源</li>
<li>将上一级交换机的网线或adsl modem接出来的网线插上路由器的 WAN 口</li>
<li>把一台电脑的网卡接口和路由器的任意一个LAN接口连接起来。</li>
<li>把电脑的网络设置为“自动获取IP”</li>
</ol>
<p>如果是迷你路由，没有多余的LAN局域网接口，那就只能让笔记本通过wifi的方式连接上路由器热点了。例如我这个路由器的热点名字就叫“OPENWRT”，默认密码在初始状态是空的。</p>
<p><strong>登录路由器管理面板，并使用向导模式设置网络</strong></p>
<p>打开浏览器，输入路由器的管理IP地址，例如我这里是 <code>192.168.1.1</code>,按提示输入默认的密码</p>
<p><img src="/article_images/tools/openwrt-config-install-php-mysql/luci_login.png" alt=""></p>
<p>默认会进入向导模式,点击下一步</p>
<p><img src="/article_images/tools/openwrt-config-install-php-mysql/guide_1.png" alt=""></p>
<p>首先设置WAN(外部接入网络)，这里的“接入协议”根据你的情况进行设置，有静态IP、自动获取IP、输入PPPoE拨号账号密码（一般家庭电信adsl就是这种）</p>
<p><img src="/article_images/tools/openwrt-config-install-php-mysql/guide_2_wan.png" alt=""></p>
<p>然后就是设置LAN(局域网)，用于你多台电脑的连接，主要是分配IP地址用，我们尽量避免 192.168.0.1 这个最常用的地址，一方面可以减少和上级网络的冲突可能，另一方面防止别人很容易猜到你的网络地址</p>
<p><img src="/article_images/tools/openwrt-config-install-php-mysql/guide_3_lan.png" alt=""></p>
<p>所有完成后就点击确定，这时候路由器会进行写入配置参数以及重启。</p>
<p><img src="/article_images/tools/openwrt-config-install-php-mysql/guide_4_finish.png" alt=""></p>
<h1 id="远程连接路由器以及进行软件升级安装新软件">远程连接路由器，以及进行软件升级、安装新软件</h1>
<p>通过任意的终端工具都可以连接到路由器（putty，xshell等).</p>
<p>首先升级下软件包</p>
<pre><code class="language-shell">opkg update
</code></pre>
<p>由于我的路由器可能在仓库里呆了很久，连openwrt的软件仓库地址变了都没有进行相应的修改，在运行上面命令的时候，会报错：</p>
<blockquote>
<p>opkg_download: Failed to download <a href="http://downloads.openwrt.org/snapshots/trunk/ar71xx/packages/Packages.gz,">http://downloads.openwrt.org/snapshots/trunk/ar71xx/packages/Packages.gz,</a> wget returned 1.</p>
</blockquote>
<p>于是修改 <code>/etc/opkg.conf</code>这个文件，把第一行改成正确的地址（在http://downloads.openwrt.org/里逐个目录去找，直到能定位到一个目录，里面有 Packages.gz 这个文件）</p>
<pre><code class="language-shell">src/gz attitude_adjustment http://downloads.openwrt.org/attitude_adjustment/12.09-beta/ar71xx/generic/packages
</code></pre>
<p>然后我装上平时用得较多的几个系统工具</p>
<pre><code class="language-shell">opkg install whereis wget net-tool ntfs-3g
</code></pre>
<h1 id="搭建web服务器">搭建web服务器</h1>
<p>前面说了，OpenWRT是一个Linux系统，所以我们可以在它上面搭建个web服务器。但是由于路由器一般性能不强（几十M内存，几百Mhz的CPU），跑比较复杂的程序会很卡，所以只是玩一玩就可以了，放一些静态文件，或者跑一些计算压力很小的的php程序、SQLite这种单文件数据库什么的。</p>
<h2 id="安装必须的依赖">安装必须的依赖</h2>
<pre><code class="language-shell">opkg install zlib libexpat uclibcxx libgd libjpeg libncurses libncursesw libopenssl libpcre libpng libpthread libreadline librt libsqlite3
</code></pre>
<h2 id="安装php">安装PHP</h2>
<pre><code class="language-shell">opkg install php5 php5-cgi php5-fastcgi php5-mod-apc php5-mod-gd php5-mod-pdo php5-mod-pdo-mysql php5-mod-mysql php5-mod-gd php5-mod-xml
</code></pre>
<p>编辑一下 <code>php.ini</code>配置文件</p>
<pre><code>[APC]
apc.enabled = 1
apc.shm_segments = 1 ;The number of shared memory segments to allocate for the compiler cache.
apc.shm_size = 4 ;The size of each shared memory segment in MB.

file_uploads = On
upload_tmp_dir = &quot;/tmp&quot;
upload_max_filesize = 200M
max_file_uploads = 200

doc_root = &quot;/mnt/www&quot;
user_dir =
extension_dir = &quot;/usr/lib/php&quot;
enable_dl = On
</code></pre>
<p>怎么重启php呢？这个以前在服务器上用php-fpm很好管理，但路由器上我不太清楚。</p>
<h2 id="安装lighttpd不建议使用apachenginx等消耗资源的web服务器">安装lighttpd（不建议使用Apache、Nginx等消耗资源的web服务器）</h2>
<pre><code class="language-shell">opkg install lighttpd lighttpd-mod-access lighttpd-mod-alias lighttpd-mod-cgi lighttpd-mod-fastcgi
</code></pre>
<p>修改 <code>lighttpd.conf</code>文件</p>
<pre><code>server.modules = (
 &quot;mod_access&quot;,
  &quot;mod_fastcgi&quot;,
  &quot;mod_alias&quot;
# &quot;mod_rewrite&quot;,
# &quot;mod_redirect&quot;,
# &quot;mod_alias&quot;,
# &quot;mod_auth&quot;,
# &quot;mod_status&quot;,
# &quot;mod_setenv&quot;,
# &quot;mod_fastcgi&quot;,
# &quot;mod_proxy&quot;,
# &quot;mod_simple_vhost&quot;,
# &quot;mod_cgi&quot;,
# &quot;mod_ssi&quot;,
# &quot;mod_usertrack&quot;,
# &quot;mod_expire&quot;,
# &quot;mod_webdav&quot;
)

server.document-root = &quot;/mnt/www&quot;

index-file.names = ( &quot;index.php&quot;,&quot;index.html&quot;, &quot;default.html&quot;, &quot;index.htm&quot;, &quot;default.htm&quot; )

server.port = 88
</code></pre>
<p>然后启动服务</p>
<pre><code class="language-shell">/etc/init.d/lighttpd start
</code></pre>
<p>在web根目录 /mnt/www 里新建一个test.php文件看看，在浏览器运行 <code>192.168.8.1:88/test.php</code> 是不是ok了？</p>
<h2 id="安装mysql内存大户不太建议使用">安装MySQL（内存大户，不太建议使用）</h2>
<pre><code class="language-shell">opkg install libmysqlclient mysql-server
</code></pre>
<p>创建默认数据库</p>
<pre><code class="language-shell">/usr/bin/mysql_install_db --force
</code></pre>
<p>如果报下面这一堆错误，说明默认数据库安装失败了</p>
<blockquote>
<p>ERROR: 1049  Unknown database &lsquo;mysql&rsquo;
110507 15:01:36 [ERROR] Aborting</p>
</blockquote>
<blockquote>
<p>110507 15:01:36 [Note] /usr/bin/mysqld: Shutdown complete</p>
</blockquote>
<blockquote>
<p>Installation of system tables failed!  Examine the logs in
/mnt/data/mysql/ for more information.</p>
</blockquote>
<blockquote>
<p>You can try to start the mysqld daemon with:</p>
</blockquote>
<blockquote>
<pre><code>shell&gt; /usr/bin/mysqld --skip-grant &amp;
</code></pre>
</blockquote>
<blockquote>
<p>and use the command line tool /usr/bin/mysql
to connect to the mysql database and look at the grant tables:</p>
</blockquote>
<blockquote>
<pre><code>shell&gt; /usr/bin/mysql -u root mysql
mysql&gt; show tables
</code></pre>
</blockquote>
<blockquote>
<p>Try &lsquo;mysqld &ndash;help&rsquo; if you have problems with paths.  Using &ndash;log
gives you a log in /mnt/data/mysql/ that may be helpful.</p>
</blockquote>
<blockquote>
<p>Please consult the MySQL manual section
&lsquo;Problems running mysql_install_db&rsquo;, and the manual section that
describes problems on your OS.  Another information source are the
MySQL email archives available at <a href="http://lists.mysql.com/">http://lists.mysql.com/</a>.</p>
</blockquote>
<blockquote>
<p>Please check all of the above before mailing us!  And remember, if
you do mail us, you MUST use the /usr/scripts/mysqlbug script!</p>
</blockquote>
<p>请下载这个包，上传到路由器上解压，然后覆盖掉 <code>/mnt/data/mysql</code>下的 <code>mysql</code>数据库</p>
<p><a href="/article_images/tools/openwrt-config-install-php-mysql/mysql.tar.gz">mysql.tar.gz</a></p>
<p>然后启动MySQL，以及设置默认的root密码（因为当前是没有root密码的）</p>
<pre><code class="language-shell">/etc/init.d/mysqld start
/usr/bin/mysqladmin -u root password '123456'
mysql -u root -p #登录试试看
/etc/init.d/mysqld stop &amp;&amp; /etc/init.d/mysqld start #重启mysql服务
</code></pre>
<p>注意要注释掉 /etc/my.cnf 里的这行，否则除了&rsquo;localhost&rsquo;,其他外部的主机是无法连接上的。</p>
<h1 id="更新固件">更新固件</h1>
<p>无法通过web更新，提示文件格式不正确</p>
<p>ssh 登录后</p>
<pre><code class="language-shell">cd /tmp
#看看空间是否足够放下这个升级固件（大概3M就可以了）
du -sh

# 地址自己去找，每个路由器型号、版本不一样
wget wget http://downloads.openwrt.org/snapshots/trunk/ar71xx/generic/openwrt-ar71xx-generi

# 这个操作会保存网络配置， 如果用 -n 就会丢失配置了
sysupgrade -v openwrt-ar71xx-generic-tl-wr2543-v1-squashfs-sysupgrade.bin
</code></pre>
<p>提示</p>
<blockquote>
<p>/sbin/sysupgrade: .: line 10: can&rsquo;t open &lsquo;/lib/upgrade/nand.sh&rsquo;</p>
</blockquote>
<p>删除这个文件，然后再次运行 <code>sysupgrade</code> 命令</p>
<pre><code class="language-shell">rm /lib/upgrade/merakinand.sh
</code></pre>
<p>提示这个错误，不过这时候已经刷完了。</p>
<blockquote>
<p>TRX header not found</p>
</blockquote>
<p>重新通过 ssh 进路由器（这时候 luci web 界面已经没有了，要重新安装）</p>
<pre><code class="language-shell">opkg update
opkg install luci
opkg install luci-i18n-chinese
/etc/init.d/uhttpd start

# 还要修改下 web 目录的权限，否则会提示 forbidden
chmod -R 755 /www
</code></pre>
<p>然后就可以登录 web 管理界面修改路由器参数了。</p>
<p>挂载U盘（根据U盘文件格式，安装不同的支持，这里我用了 Ext4）</p>
<pre><code class="language-shell">
</code></pre>
    </div>
    <div class="article-footer">
<blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接: </strong>
      <a href="https://my101du.github.io/1/01/openwrt%E8%B7%AF%E7%94%B1%E5%99%A8%E9%85%8D%E7%BD%AE-%E5%AE%89%E8%A3%85php%E5%92%8Cmysql%E7%AD%89/" title="" target="_blank" rel="external">https://my101du.github.io/1/01/openwrt%E8%B7%AF%E7%94%B1%E5%99%A8%E9%85%8D%E7%BD%AE-%E5%AE%89%E8%A3%85php%E5%92%8Cmysql%E7%AD%89/</a>
    </li>
    <li class="post-copyright-license">
      <strong>License：</strong><a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN</a>
    </li>
  </ul>
</blockquote>

<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="https://github.com/my101du" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="https://avatars2.githubusercontent.com/u/1332645?s=460&amp;u=dc114d6baad010456a5af87c4cc2df0694ff2b1c&amp;v=4" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="https://github.com/my101du" target="_blank"><span class="text-dark">my101du</span><small class="ml-1x"></small></a></h3>
        <div>Stay Hungry, Stay Foolish</div>
      </div>
    </figure>
  </div>
</div>
    </div>
  </article>
<section id="comments">
</section>

</div><nav class="bar bar-footer clearfix" data-stick-bottom>
    <div class="bar-inner">
        <ul class="pager pull-left">
            <li class="prev">
                <a href="https://my101du.github.io/1/01/photoshop%E6%95%99%E7%A8%8B/" title=""><i
                        class="icon icon-angle-left"
                        aria-hidden="true"></i><span>&nbsp;&nbsp;下一篇</span></a>
            </li>
            <li class="next">
                <a href="https://my101du.github.io/1/01/office-%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/"
                    title=""><span>上一篇&nbsp;&nbsp;</span><i
                        class="icon icon-angle-right" aria-hidden="true"></i></a>
            </li>
            
            <li class="toggle-toc">
                <a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false"
                    title="文章目录" role="button">
                    <span>[&nbsp;</span><span>文章目录</span>
                    <i class="text-collapsed icon icon-anchor"></i>
                    <i class="text-in icon icon-close"></i>
                    <span>]</span>
                </a>
            </li>
        </ul>
        <div class="bar-right">
            <div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter"
                data-mobile-sites="weibo,qq,qzone"></div>
        </div>
    </div>
</nav>

</main><footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
<ul class="social-links">
    <li><a href="https://github.com/my101du" target="_blank" title="github" data-toggle=tooltip data-placement=top >
            <i class="icon icon-github"></i></a></li>
    <li><a href="https://my101du.github.io/index.xml" target="_blank" title="rss" data-toggle=tooltip data-placement=top >
            <i class="icon icon-rss"></i></a></li>
</ul>
  <div class="copyright">
    &copy;2017  -
    2020
    <div class="publishby">
        Theme by <a href="https://github.com/xiaoheiAh" target="_blank"> xiaoheiAh </a>base on<a href="https://github.com/xiaoheiAh/hugo-theme-pure" target="_blank"> pure</a>.
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_SVG"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
            showMathMenu: false, //disables context menu
            tex2jax: {
            inlineMath: [ ['$','$'], ['\\(','\\)'] ]
           }
    });
</script>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
<script>
    window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>
<script type="text/javascript" src="https://cdn.staticfile.org/highlight.js/9.15.10/highlight.min.js"></script>
<script type="text/javascript" src="https://cdn.staticfile.org/highlight.js/9.15.10/languages/javascript.min.js" defer></script>
<script type="text/javascript" src="https://cdn.staticfile.org/highlight.js/9.15.10/languages/php.min.js" defer></script><script>
    hljs.configure({
        tabReplace: '    ', 
        classPrefix: ''     
        
    })
    hljs.initHighlightingOnLoad();
</script>
<script src="https://my101du.github.io/js/application.min.bdeb64b910570b6c41badc6a05b7afb0c8ad9efd8525de3c7257d59e786326a3.js"></script>
<script src="https://my101du.github.io/js/plugin.min.51ff8c7317566f82259170fa36e09c4493adc9b9378b427a01ad3f017ebac7dd.js"></script>

<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: '文章',
                PAGES: '页面',
                CATEGORIES: '分类',
                TAGS: '标签',
                UNTITLED: '(未命名)',
            },
            ROOT_URL: 'https:\/\/my101du.github.io\/',
            CONTENT_URL: 'https:\/\/my101du.github.io\/\/searchindex.json ',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script type="text/javascript" src="https://my101du.github.io/js/insight.min.a343cd9a5a7698336b28ef3a7c16a3a1b1d2d5fb17dc8ed04022bbe08cc5459073a15bdafa3a8a58cdd56080784bdd69fa70b1ae8597565c799c57ed00f0e120.js" defer></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
<script>
    tocbot.init({
        
        tocSelector: '.js-toc',
        
        contentSelector: '.js-toc-content',
        
        headingSelector: 'h1, h2, h3',
        
        hasInnerContainers: true,
    });
</script>


  </body>
</html>
